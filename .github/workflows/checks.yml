# Github Actions CI/CD(배포 전/ 배포)
---
name: Checks # WorkFlow 이름

on: [push] # git push 이벤트 활성화 -> 레포지토리에 push를 했을 때 활성화

jobs:
  test-lint:
   name: Test and Lint
   runs-on: ubuntu-20.04 # 작업 환경
   steps: # 작업 단계
    - name: Login in to Docker Hub
      uses: docker/login-action@v1 # login을 도와주는 라이브러리
      with:
        username: ${{ secrets.DOCKERHUB_USER }} # github actions 토큰이랑 이름이 같아야 함
        password: ${{ secrets.DOCKERHUB_TOKEN }} # github actions 토큰이랑 이름이 같아야 함
    - name: Check out - pull reposiitory code # Github에 있는 코드(image)를 작업 환경으로 가져오는 역할
      uses: actions/checkout@v2
    - name: Run Test-Code
      run: docker-compose run --rm app sh -c 'python manage.py test' # 환경이 달라도 코드를 실행할 수 있는게 docker
    - name: Run Flake8 for Lint Check #  PEP8 style 가이드를 잘 준수하고 있나
      run: docker-compose run --rm app sh -c 'flake8'